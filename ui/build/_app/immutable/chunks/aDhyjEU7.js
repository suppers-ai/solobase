import{d as c,w as i}from"./BT7rIR0U.js";import{a as n}from"./DCFqKId7.js";function d(){const{subscribe:s,set:t,update:l}=i({user:null,roles:[],loading:!0,error:null});return{subscribe:s,async login(e,o){l(a=>({...a,loading:!0,error:null})),console.log("Attempting login for:",e);const r=await n.login({email:e,password:o});if(console.log("Login response:",r),r.error)return console.error("Login failed:",r.error),l(a=>({...a,loading:!1,error:r.error})),!1;console.log("Login successful, user:",r.data.user);const g=n.getRolesFromToken();return console.log("User roles from token:",g),t({user:r.data.user,roles:g,loading:!1,error:null}),!0},async logout(){console.log("Logging out..."),await n.logout(),t({user:null,roles:[],loading:!1,error:null}),console.log("Logout complete, auth store cleared")},async checkAuth(){l(r=>({...r,loading:!0})),console.log("Checking auth status...");const e=await n.getCurrentUser();if(console.log("Current user response:",e),e.error)return console.log("Auth check failed:",e.error),t({user:null,roles:[],loading:!1,error:null}),!1;console.log("Auth check successful, user:",e.data);const o=n.getRolesFromToken();return console.log("User roles from token:",o),t({user:e.data,roles:o,loading:!1,error:null}),!0},setUser(e){l(o=>({...o,user:e}))},updateUser(e){l(o=>({...o,user:e}))}}}const u=d(),p=u;c(u,s=>!!s.user);const m=c(u,s=>s.user),k=c(u,s=>s.roles);export{p as a,u as b,m as c,k as u};
